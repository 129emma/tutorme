<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
      integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<html>

<!-- The included template contains all the links, JS and Styling files to be included in the pages, to alter the contents please refer to templates/included.html file -->
<% include ../templates/included.html %>

<head>
    <title>Tutor Profile page</title>
    <link rel="stylesheet" href="/stylesheets/profile.css"/>

    <style>
        .loader {
            border: 16px solid #f3f3f3; /* Light grey */
            border-top: 16px solid #3498db; /* Blue */
            border-radius: 50%;
            width: 120px;
            height: 120px;
            animation: spin 2s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

    </style>
</head>
<body>
<!--The navbar template included below, to alter the contents please refer to templates/navbar.ejs file-->
<% include ../templates/navbar.ejs %>
<% include ../../javascript/ajaxDatabaseExpresso.ejs %>

<div class="ui middle aligned grid" id="profile">
    <div class="ui text container">
        <h1>Welcome to your profile, <%= userDetails[0].firstName %></h1>
        <p>Edit your general Profile Details</p>
        <div>
            <img src="http://style.anu.edu.au/_anu/4/images/placeholders/person.png" style="width: 100px;"/>
        </div>
        <div id="generalProfileDetails">
            <form class="ui form">
                <div class="inline two fields">
                    <div class="field">
                        <label>Username</label>
                        <input type="hidden" name="formUsername"
                               value="<%= userDetails[0].userName %>"><%= userDetails[0].userName %>
                    </div>
                    <div class="field">
                        <label>Date of birth</label>
                        <input type="date" name="formDOB" value="<%= userDetails[0].dob %>" disabled>
                    </div>
                </div>
                <div class="field">
                    <label>Name</label>
                    <div class="two fields">
                        <div class="field">
                            <input type="text" name="formFirstname" value="<%= userDetails[0].firstName %>"
                                   placeholder="First Name">
                        </div>
                        <div class="field">
                            <input type="text" name="formLastname" value="<%= userDetails[0].lastName %>"
                                   placeholder="Last Name">
                        </div>
                    </div>
                </div>
                <div class="field">
                    <label>Email</label>
                    <input type="text" name="formEmail" value="<%= userDetails[0].email %>" disabled
                           placeholder="Email">
                </div>
                <div class="field">
                    <label>Address</label>
                    <input type="text" name="formAddress" value="<%= userDetails[0].address %>" placeholder="Address">
                </div>
                <div class="inline two fields">
                    <div class="field">
                        <label>Student ID</label>
                        <input type="text" name="formID" value="<%= userDetails[0].studentID %>">
                    </div>
                    <div class="field">
                        <label>Study Institution</label>
                        <input type="text" name="formSchool" value="<%= userDetails[0].studySchool %>">
                    </div>
                </div>
                <div class="inline two fields">
                    <div class="field">
                        <label>Joined Tutorme</label>
                        <input type="text" value="<%= userDetails[0].joinDate %>" disabled>
                    </div>
                    <div class="field">
                        <!--<label>Activated as a tutor</label>
                    <div class="ui toggle checkbox">
                        <input type="checkbox" tabindex="0" value="<% if (userDetails[0].tutor_activation === 1) { %>
                Yes
                <% } else { %>
                No
                <% } %>" disabled>
                    </div>-->

                        <div class="ui toggle checkbox">
                            <input type="checkbox" tabindex="0" alue="<% if (userDetails[0].tutor_activation === 1) { %>
                Yes
                <% } else { %>
                No
                <% } %>">
                            <label>Activated as a tutor</label>
                        </div>
                    </div>
                </div>
                <div class="field">
                    <div class="field">
                        <label>Introduction</label>
                        <input type="text" name="formUsername" value="<%= Data[0].selfIntroduction %>" disabled>
                    </div>
                </div>

                <div id="tutorCourseDetails">
                    <h4 class="ui dividing header">Courses you can tutor</h4>


                    <!--courselist generated from DB table of courseList and datalist options listed for all existing instances of courses-->
                    <input list="courses" type="text" id="myInput" placeholder="Course...">
                    <datalist id="courses">
                        <% for (var i = 0; i < CourseList.length; i++) { %>
                        <option value="<%= CourseList[i].courseID %>">
                            <% } %>
                    </datalist>






                    <button type="button" class="btn btn-info btn-lg" onclick="coursePopup()" data-toggle="modal"
                            data-target="#myModal">Add
                    </button>

                    <span onclick="newElement()" class="addBtn">Add</span>
                    <ul id="tutorCourseList" class="list-group list-group-flush">

                        <!--For loop checking through obtained Capability information and list all the courses that is the tutors capability -->
                        <% for (var i = 0; i < Data.length; i++){ %>
                        <li class="list-group-item"><span
                                    onclick="console.log(this.innerHTML)"><%= Data[i].courseID %></span><span
                                    style="float: right"><%= Data[i].grade %></span></li>
                        <% } %>

                    </ul>

                </div>

                <input type="submit" value="Submit" class="ui fluid teal submit button">
            </form>
        </div>
    </div>
</div>


<!-- Modal -->
<div id="myModal" class="ui modal fade" role="dialog">
    <div class="modal-dialog">
        <!-- Modal content-->
        <div class="header">
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Course name</h4>
        </div>
        <div class="content">
            <h3>About the course: </h3>
            <div class="loader_container"></div>
            <p></p>
            <form method="POST" action="/tutor/profile/create_cap">
                <fieldset>
                    <legend>About yourself:</legend>

                    <input type="hidden" id="courseID" value="none" name="courseID">
                    Your experience:<br>
                    <textarea name="experience" rows="4" cols="70">Your experience in this course.</textarea>
                    <br>

                    Describe what you can do?<br>
                    <textarea name="description" rows="4"
                              cols="70">What can you teach in regard to this course?</textarea><br>
                    grade: <br>
                    <select name="grade">
                        <option value="A+">A+</option>
                        <option value="A">A</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B">B</option>
                        <option value="B-">B-</option>
                        <option value="N/A">N/A</option>
                    </select>
                    <br><br>
                    Verification: <br>
                    <input type="radio" name="verification" value="1"> Verified
                    <input type="radio" name="verification" value="0" checked> Unverified<br>
                </fieldset>
                <div class="modal-footer">
                    <input type="submit" class="btn btn-default" value="create">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </form>
        </div>

    </div>
</div>


<script>
    // Create a new list item when clicking on the "Add" button


    function coursePopup() {

        var courseID = document.getElementById("myInput").value;
        document.getElementsByClassName('modal-title')[0].innerHTML = courseID;
        document.getElementById('courseID').value = courseID;
        document.querySelector(".modal-body p").innerHTML = "";
        var loader = document.createElement('div');
        loader.className = 'loader';
// The variable iDiv is still good... Just append to it.
        document.getElementsByClassName("loader_container")[0].appendChild(loader);

        console.log(courseID);
        console.log(typeof (courseID));
        ajaxDatabaseExpress("SELECT * FROM tableCourseList WHERE courseID = '" + courseID + "';", function (data) {
            document.getElementsByClassName('modal-title')[0].innerHTML = data[0].courseID + ": " + data[0].courseName;
            loader.parentNode.removeChild(loader);
            document.querySelector(".modal-body p").innerHTML = data[0].courseDescription;
        });
    }

    function newElement() {
        var li = document.createElement("li");
        var inputValue = document.getElementById("myInput").value;
        var t = document.createTextNode(inputValue);
        li.setAttribute("class", "list-group-item")
        li.appendChild(t);
        if (inputValue === '') {
            alert("You must write something!");
        } else {
            document.getElementById("tutorCourseList").appendChild(li);
        }
        document.getElementById("myInput").value = "";

        var span = document.createElement("SPAN");
        var txt = document.createTextNode("\u00D7");
        span.className = "close";
        span.appendChild(txt);
        li.appendChild(span);

        for (i = 0; i < close.length; i++) {
            close[i].onclick = function () {
                var div = this.parentElement;
                div.style.display = "none";
            }
        }
    }




    //demo code for using ajaxDatabaseExpress
    //ajaxDatabaseExpress("SELECT * FROM tableCourseList", alert);

</script>

</body>
</html>